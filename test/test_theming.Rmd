---
title: "test_grattantheme"
author: "Jessie Huang"
date: "2023-11-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(PHC6099FinalProject)
library(ggplot2)
# library(grattantheme)
```

```{r utils}
# Non-exported utility functions

# Given a number of points, convert to mm
#' @importFrom grid convertX

points_to_mm <- function(points) {
  as.numeric(grid::convertX(ggplot2::unit(points, "points"), "mm"))[1]
}

cm_to_in <- function(cm, round = FALSE) {
  inches <- cm / 2.54

  if (isTRUE(round)) {
    round(inches, 2)
  } else {
    inches
  }
}
```

```{r colors}
# Define grattan colours =======================================================
base_yellow <<- dplyr::if_else(options("grattan_palette") == "old", "#FFE07F", "#3E0E39")
base_darkyellow <- dplyr::if_else(options("grattan_palette") == "old", "#FFC35A", "#F5B50C")
base_orange <-  dplyr::if_else(options("grattan_palette") == "old", "#F68B33", "#EF7900")
base_darkorange <- "#D4582A" #unchanged
base_red <- dplyr::if_else(options("grattan_palette") == "old", "#A02226", "#A1253E")
base_darkred <- dplyr::if_else(options("grattan_palette") == "old", "#621214", "#611633")
base_blue <- dplyr::if_else(options("grattan_palette") == "old", "#A3C7DF", "#6A99C4")
base_darkblue <- dplyr::if_else(options("grattan_palette") == "old", "#3E81CE", "#4371A1")

# Yellow light ----
yellow_palette <- grDevices::colorRampPalette(c(base_yellow, "white"))(10)

#' grattan_lightyellow
#'
#' @export
#'
grattan_lightyellow <- yellow_palette[1]

#' grattan_lightyellow1
#'
#' @export
#'
grattan_lightyellow1 <- yellow_palette[2]

#' grattan_lightyellow2
#'
#' @export
#'
grattan_lightyellow2 <- yellow_palette[3]

#' grattan_lightyellow3
#'
#' @export
#'
grattan_lightyellow3 <- yellow_palette[4]

#' grattan_lightyellow4
#'
#' @export
#'
grattan_lightyellow4 <- yellow_palette[5]

#' grattan_lightyellow5
#'
#' @export
#'
grattan_lightyellow5 <- yellow_palette[6]
#' grattan_lightyellow6
#'
#' @export
#'
grattan_lightyellow6 <- yellow_palette[7]

#' grattan_lightyellow7
#'
#' @export
#'
grattan_lightyellow7 <- yellow_palette[8]

#' grattan_lightyellow8
#'
#' @export
#'
grattan_lightyellow8 <- yellow_palette[9]

# Yellow dark ----
darkyellow_palette <- grDevices::colorRampPalette(c(base_darkyellow, "white"))(10)

#' '
#'
#' @export
#'
grattan_darkyellow <- darkyellow_palette[1]

#' '
#'
#' @export
#'
grattan_darkyellow1 <- darkyellow_palette[2]

#' '
#'
#' @export
#'
grattan_darkyellow2 <- darkyellow_palette[3]

#' '
#'
#' @export
#'
grattan_darkyellow3 <- darkyellow_palette[4]

#' '
#'
#' @export
#'
grattan_darkyellow4 <- darkyellow_palette[5]

#' '
#'
#' @export
#'
grattan_darkyellow5 <- darkyellow_palette[6]

#' '
#'
#' @export
#'
grattan_darkyellow6 <- darkyellow_palette[7]

#' '
#'
#' @export
#'
grattan_darkyellow7 <- darkyellow_palette[8]

#' '
#'
#' @export
#'
grattan_darkyellow8 <- darkyellow_palette[9]



#' '
#'
#' @export
#'
grattan_yellow <- grattan_darkyellow


#' '
#'
#' @export
#'
grattan_yellow1 <- grattan_darkyellow1


#' '
#'
#' @export
#'
grattan_yellow2 <- grattan_darkyellow2


#' '
#'
#' @export
#'
grattan_yellow3 <- grattan_darkyellow3


#' '
#'
#' @export
#'
grattan_yellow4 <- grattan_darkyellow4


#' '
#'
#' @export
#'
grattan_yellow5 <- grattan_darkyellow5


#' '
#'
#' @export
#'
grattan_yellow6 <- grattan_darkyellow6


#' '
#'
#' @export
#'
grattan_yellow7 <- grattan_darkyellow7


#' '
#'
#' @export
#'
grattan_yellow8 <- grattan_darkyellow8


# Orange light ----------
orange_palette <- grDevices::colorRampPalette(c(base_orange, "white"))(10)

#' '
#'
#' @export
#'
grattan_lightorange <- orange_palette[1]

#' '
#'
#' @export
#'
grattan_lightorange1 <- orange_palette[2]

#' '
#'
#' @export
#'
grattan_lightorange2 <- orange_palette[3]

#' '
#'
#' @export
#'
grattan_lightorange3 <- orange_palette[4]

#' '
#'
#' @export
#'
grattan_lightorange4 <- orange_palette[5]

#' '
#'
#' @export
#'
grattan_lightorange5 <- orange_palette[6]

#' '
#'
#' @export
#'
grattan_lightorange6 <- orange_palette[7]

#' '
#'
#' @export
#'
grattan_lightorange7 <- orange_palette[8]

#' '
#'
#' @export
#'
grattan_lightorange8 <- orange_palette[9]


#' '
#'
#' @export
#'
grattan_orange <- grattan_lightorange

#' '
#'
#' @export
#'
grattan_orange1 <- grattan_lightorange1

#' '
#'
#' @export
#'
grattan_orange2 <- grattan_lightorange2

#' '
#'
#' @export
#'
grattan_orange3 <- grattan_lightorange3

#' '
#'
#' @export
#'
grattan_orange4 <- grattan_lightorange4

#' '
#'
#' @export
#'
grattan_orange5 <- grattan_lightorange5

#' '
#'
#' @export
#'
grattan_orange6 <- grattan_lightorange6

#' '
#'
#' @export
#'
grattan_orange7 <- grattan_lightorange7

#' '
#'
#' @export
#'
grattan_orange8 <- grattan_lightorange8


# dark:
darkorange_palette <- grDevices::colorRampPalette(c(base_darkorange, "white"))(10)


#' '
#'
#' @export
#'
grattan_darkorange <- darkorange_palette[1]


#' '
#'
#' @export
#'
grattan_darkorange1 <- darkorange_palette[2]


#' '
#'
#' @export
#'
grattan_darkorange2 <- darkorange_palette[3]


#' '
#'
#' @export
#'
grattan_darkorange3 <- darkorange_palette[4]


#' '
#'
#' @export
#'
grattan_darkorange4 <- darkorange_palette[5]


#' '
#'
#' @export
#'
grattan_darkorange5 <- darkorange_palette[6]


#' '
#'
#' @export
#'
grattan_darkorange6 <- darkorange_palette[7]


#' '
#'
#' @export
#'
grattan_darkorange7 <- darkorange_palette[8]


#' '
#'
#' @export
#'
grattan_darkorange8 <- darkorange_palette[9]



# Red --------------
# light:
red_palette <- grDevices::colorRampPalette(c(base_red, "white"))(10)


#' '
#'
#' @export
#'
grattan_lightred <- red_palette[1]


#' '
#'
#' @export
#'
grattan_lightred1 <- red_palette[2]


#' '
#'
#' @export
#'
grattan_lightred2 <- red_palette[3]


#' '
#'
#' @export
#'
grattan_lightred3 <- red_palette[4]


#' '
#'
#' @export
#'
grattan_lightred4 <- red_palette[5]


#' '
#'
#' @export
#'
grattan_lightred5 <- red_palette[6]


#' '
#'
#' @export
#'
grattan_lightred6 <- red_palette[7]


#' '
#'
#' @export
#'
grattan_lightred7 <- red_palette[8]


#' '
#'
#' @export
#'
grattan_lightred8 <- red_palette[9]



#' '
#'
#' @export
#'
grattan_red <- grattan_lightred


#' '
#'
#' @export
#'
grattan_red1 <- grattan_lightred1


#' '
#'
#' @export
#'
grattan_red2 <- grattan_lightred2


#' '
#'
#' @export
#'
grattan_red3 <- grattan_lightred3


#' '
#'
#' @export
#'
grattan_red4 <- grattan_lightred4


#' '
#'
#' @export
#'
grattan_red5 <- grattan_lightred5


#' '
#'
#' @export
#'
grattan_red6 <- grattan_lightred6


#' '
#'
#' @export
#'
grattan_red7 <- grattan_lightred7


#' '
#'
#' @export
#'
grattan_red8 <- grattan_lightred8



# dark:
darkred_palette <- grDevices::colorRampPalette(c(base_darkred, "white"))(10)


#' '
#'
#' @export
#'
grattan_darkred <- darkred_palette[1]


#' '
#'
#' @export
#'
grattan_darkred1 <- darkred_palette[2]


#' '
#'
#' @export
#'
grattan_darkred2 <- darkred_palette[3]


#' '
#'
#' @export
#'
grattan_darkred3 <- darkred_palette[4]


#' '
#'
#' @export
#'
grattan_darkred4 <- darkred_palette[5]


#' '
#'
#' @export
#'
grattan_darkred5 <- darkred_palette[6]


#' '
#'
#' @export
#'
grattan_darkred6 <- darkred_palette[7]

#' '
#'
#' @export
#'
grattan_darkred7 <- darkred_palette[8]

#' '
#'
#' @export
#'
grattan_darkred8 <- darkred_palette[9]

# Blue -------------------------------------------------------------------------
# light:
blue_palette <- grDevices::colorRampPalette(c(base_blue, "white"))(10)


#' '
#'
#' @export
#'
grattan_lightblue <- blue_palette[1]


#' '
#'
#' @export
#'
grattan_lightblue1 <- blue_palette[2]


#' '
#'
#' @export
#'
grattan_lightblue2 <- blue_palette[3]


#' '
#'
#' @export
#'
grattan_lightblue3 <- blue_palette[4]


#' '
#'
#' @export
#'
grattan_lightblue4 <- blue_palette[5]


#' '
#'
#' @export
#'
grattan_lightblue5 <- blue_palette[6]


#' '
#'
#' @export
#'
grattan_lightblue6 <- blue_palette[7]


#' '
#'
#' @export
#'
grattan_lightblue7 <- blue_palette[8]


#' '
#'
#' @export
#'
grattan_lightblue8 <- blue_palette[9]


#' '
#'
#' @export
#'
grattan_blue <- grattan_lightblue


#' '
#'
#' @export
#'
grattan_blue1 <- grattan_lightblue1


#' '
#'
#' @export
#'
grattan_blue2 <- grattan_lightblue2


#' '
#'
#' @export
#'
grattan_blue3 <- grattan_lightblue3


#' '
#'
#' @export
#'
grattan_blue4 <- grattan_lightblue4


#' '
#'
#' @export
#'
grattan_blue5 <- grattan_lightblue5


#' '
#'
#' @export
#'
grattan_blue6 <- grattan_lightblue6


#' '
#'
#' @export
#'
grattan_blue7 <- grattan_lightblue7


#' '
#'
#' @export
#'
grattan_blue8 <- grattan_lightblue8



# dark:
darkblue_palette <- grDevices::colorRampPalette(c(base_darkblue, "white"))(10)

#' '
#'
#' @export
#'
grattan_darkblue <- darkblue_palette[1]

#' '
#'
#' @export
#'
grattan_darkblue1 <- darkblue_palette[2]

#' '
#'
#' @export
#'
grattan_darkblue2 <- darkblue_palette[3]

#' '
#'
#' @export
#'
grattan_darkblue3 <- darkblue_palette[4]

#' '
#'
#' @export
#'
grattan_darkblue4 <- darkblue_palette[5]

#' '
#'
#' @export
#'
grattan_darkblue5 <- darkblue_palette[6]

#' '
#'
#' @export
#'
grattan_darkblue6 <- darkblue_palette[7]
#' '
#'
#' @export
#'
grattan_darkblue7 <- darkblue_palette[8]

#' '
#'
#' @export
#'
grattan_darkblue8 <- darkblue_palette[9]


# black ----

#' '
#'
#' @export
#'
grattan_black <- "#000000"

# grey ------

# light

#' '
#'
#' @export
#'
grattan_lightgrey <- "#828282"

#' '
#'
#' @export
#'
grattan_lightgrey1 <- "#8F8F8F"

#' '
#'
#' @export
#'
grattan_lightgrey2 <- "#9B9B9B"

#' '
#'
#' @export
#'
grattan_lightgrey3 <- "#A8A8A8"

#' '
#'
#' @export
#'
grattan_lightgrey4 <- "#B4B4B4"

#' '
#'
#' @export
#'
grattan_lightgrey5 <- "#C1C1C1"

#' '
#'
#' @export
#'
grattan_lightgrey6 <- "#CDCDCD"



#' '
#'
#' @export
#'
grattan_lightgrey7 <- "#DADADA"

#' '
#'
#' @export
#'
grattan_lightgrey8 <- "#E6E6E6"

# dark
#' '
#'
#' @export
#'
grattan_darkgrey <- "#575757"

#' '
#'
#' @export
#'
grattan_darkgrey1 <- "#686868"

#' '
#'
#' @export
#'
grattan_darkgrey2 <- "#797979"

#' '
#'
#' @export
#'
grattan_darkgrey3 <- "#898989"

#' '
#'
#' @export
#'
grattan_darkgrey4 <- "#9A9A9A"

#' '
#'
#' @export
#'
grattan_darkgrey5 <- "#ABABAB"

#' '
#'
#' @export
#'
grattan_darkgrey6 <- "#BCBCBC"

#' '
#'
#' @export
#'
grattan_darkgrey7 <- "#CDCDCD"

#' '
#'
#' @export
#'
grattan_darkgrey8 <- "#DDDDDD"

# Add other specific Grattan colours
#' '
#'
#' @export
#'
grattan_grey1 <- "#D9D9D9"

#' '
#'
#' @export
#'
grattan_grey2 <- "#AEAEAE"

#' '
#'
#' @export
#'
grattan_grey3 <- "#828282"

#' '
#'
#' @export
#'
grattan_grey4 <- "#575757"

#' '
#'
#' @export
#'
grattan_grey5 <- "#2B2B2B"

#' '
#'
#' @export
#'
grattan_grey_alpha <- "#E1E3E5"

#' grattan_grey_title
#'
#' @export
#'
grattan_grey_title <- "#6A737B"

#' grattan_gridlinegrey
#'
#' @export
#'
grattan_gridlinegrey <- "#C3C7CB"

#' '
#'
#' @export
#'
grattan_orange_alpha <- "#FEF0DE"

#' '
#'
#' @export
#'
grattan_box <- "#FEF0DE"

# Add legacy items
grattan_lightyellow_f <- "#FFE79F"
grattan_yellow_f <- "#FFD283"
grattan_lightorange_f <- "#F8A866"
grattan_orange_f <- "#F8A866"
grattan_darkorange_f <- "#DE815F"
grattan_red_f <- "#B7595C"
grattan_darkred_f <- "#894D4E"


#' A list of Grattan colour sets
#'
#' "full": red, dark orange, light orange, yellow, light yellow
#' "full_f": faded version of "full"
#' "light": light orange, yellow, light yellow
#' "dark": red, dark orange, light orange
#' "diverging": red, faded red, white, faded light orange, light orange
#' "grey": grey 1, grey 2, grey 3, grey 4, grey 5
"grattan_palette_set"
```

```{r geom-defaults}
cbi_geom_defaults <- function() {
  # Setting consistent defaults for individual geoms

  # TODO: update_geom_defaults() could be deprecated in a
  # future ggplot2
  # release (see https://github.com/tidyverse/ggplot2/pull/2749)
  # when this happens, code below will have to be replaced
  update_geom_defaults('point',
                       list(colour = PHC6099FinalProject::cbi_base_lightblue,
                            size = 6 / .pt))
  update_geom_defaults('line',
                       list(colour = PHC6099FinalProject::cbi_base_lightblue,
                            size = 3 / .pt))
  update_geom_defaults('text',
                       list(colour = PHC6099FinalProject::cbi_base_black,
                            size = 18 / .pt))
  update_geom_defaults('label',
                       list(size = 18 / .pt,
                            fill = PHC6099FinalProject::cbi_base_white,
                            colour = PHC6099FinalProject::cbi_base_lightblue))
}
```

```{r theme-grattan-normal}
# This function is called by `theme_grattan` but is not exported.

theme_grattan_normal <- function(base_size = 18,
                                 base_family = "sans",
                                 flipped = FALSE,
                                 background = "white",
                                 legend = "none",
                                 panel_borders = FALSE) {
  ret <- theme_grattan_base(
    base_size = base_size,
    base_family = base_family,
    background = background,
    legend = legend,
    panel_borders = panel_borders
  )


  # reverse when flipped = TRUE; only if type = 'normal'
  if (isTRUE(flipped)) {
    ret <- ret %+replace%
      ggplot2::theme(
        panel.grid.major.y = ggplot2::element_blank(),
        axis.line.x = ggplot2::element_blank(),
        axis.ticks.x = ggplot2::element_blank(),
        axis.title.y = ggplot2::element_blank()
      )
  } else {
    ret <- ret %+replace%
      ggplot2::theme(
        axis.line.y = ggplot2::element_blank(),
        axis.ticks.y = ggplot2::element_blank(),
        axis.title.y = ggplot2::element_blank(),
        panel.grid.major.x = ggplot2::element_blank()
      )
  }

  ret

}
```

```{r theme-grattan-scatter}
# This function is called by `theme_grattan` but is not exported.

theme_grattan_scatter <- function(base_size = 18,
                                  base_family = "sans",
                                  background = "white",
                                  legend = "none",
                                  panel_borders = FALSE) {

  ret <- theme_grattan_base(base_size = base_size,
                            base_family = base_family,
                            background = background,
                            legend = legend,
                            panel_borders = panel_borders)

  ret

}
```

```{r theme-grattan-base}
# This function is called by `theme_grattan` but is not exported.

theme_grattan_base <- function(base_size = 18,
                               base_family = "sans",
                               base_line_size = points_to_mm(0.75),
                               base_rect_size = points_to_mm(1),
                               background = "white",
                               legend = "none",
                               panel_borders = FALSE) {

  half_line <- base_size / 2

  ret <-
    theme(
      line = element_line(
        colour = PHC6099FinalProject::cbi_base_lightblue,
        linewidth = base_line_size,
        linetype = 1,
        lineend = "butt"
      ),
      rect = element_rect(
        fill = background,
        colour = PHC6099FinalProject::cbi_base_lightblue,
        linewidth = base_rect_size,
        linetype = 0
      ),
      text = element_text(
        colour = "black",
        family = base_family,
        face = "plain",
        hjust = 0.5,
        vjust = 0.5,
        angle = 0,
        lineheight = 0.9,
        debug = FALSE,
        margin = margin(),
        size = base_size
      ),
      axis.line = element_line(
        linewidth = points_to_mm(1),
        colour = "black"
      ),
      axis.line.x = NULL,
      axis.line.y = NULL,
      axis.text = element_text(size = rel(1)),
      axis.text.x = element_text(margin = margin(t = base_size / 5,
                                                 unit = "pt"),
                                 vjust = 1),
      axis.text.x.top = element_text(margin = margin(b = base_size / 5),
                                     vjust = 0),
      axis.text.y = element_text(margin = margin(r = base_size / 5),
                                 hjust = 1),
      axis.text.y.right = element_text(margin = margin(l = base_size / 5),
                                       hjust = 0),
      axis.ticks = element_line(colour = "black"),
      axis.ticks.length = unit(half_line / 2, "pt"),
      axis.ticks.length.x = NULL,
      axis.ticks.length.x.top = NULL,
      axis.ticks.length.x.bottom = NULL,
      axis.ticks.length.y = NULL,
      axis.ticks.length.y.left = NULL,
      axis.ticks.length.y.right = NULL,
      axis.title = element_text(size = rel(1)),
      axis.title.x = element_text(margin = margin(t = half_line / 2),
                                  vjust = 1),
      axis.title.x.top = element_text(margin = margin(b = half_line / 2),
                                      vjust = 0),
      axis.title.y = element_text(
        angle = 90,
        margin = margin(r = half_line /
                          2),
        vjust = 1
      ),
      axis.title.y.right = element_text(
        angle = -90,
        margin = margin(l = half_line /
                          2),
        vjust = 0
      ),
      legend.background = element_rect(colour = NA),
      legend.spacing = unit(half_line, "pt"),
      legend.spacing.x = NULL,
      legend.spacing.y = NULL,
      legend.margin = margin(),
      legend.key = element_rect(fill = "white",
                                colour = "white"),
      legend.key.size = unit(1, "lines"),
      legend.key.height = NULL,
      legend.key.width = NULL,
      legend.text = element_text(size = rel(1),
                                 margin = margin(l = 0,
                                                 r = base_size / 4, unit = "pt")),
      legend.text.align = 0,
      legend.title = element_blank(),
      legend.title.align = NULL,
      legend.position = legend,
      legend.direction = "horizontal",
      legend.justification = "center",
      legend.box = "vertical",
      legend.box.margin = margin(0, 0,
                                 0, 0, "cm"),
      legend.box.background = element_blank(),
      legend.box.spacing = unit(half_line, "pt"),
      panel.background = element_rect(colour = NA),
      panel.border = element_blank(),
      panel.grid = element_line(colour = PHC6099FinalProject::cbi_base_lightblue,
                                linewidth = points_to_mm(0.5)),
      panel.grid.minor = element_blank(),
      panel.spacing = unit(1,
                           "lines"),
      panel.spacing.x = NULL,
      panel.spacing.y = NULL,
      panel.ontop = FALSE,
      strip.background = element_rect(),
      strip.text = element_text(
        size = rel(1),
        margin = margin(0.8 * half_line,
                        0.8 * half_line, 0.8 * half_line, 0.8 * half_line)
      ),
      strip.text.x = NULL,
      strip.text.y = element_text(angle = -90),
      strip.placement = "inside",
      strip.placement.x = NULL,
      strip.placement.y = NULL,
      strip.switch.pad.grid = unit(half_line / 2,
                                   "pt"),
      strip.switch.pad.wrap = unit(half_line / 2,
                                   "pt"),
      plot.background = element_rect(),
      plot.title.position = "plot",
      plot.caption.position = "plot",
      plot.title = element_text(
        size = rel(1),
        hjust = 0,
        vjust = 1,
        colour = PHC6099FinalProject::cbi_base_lightblue,
        face = "bold",
        margin = margin(b = half_line)
      ),
      plot.subtitle = element_text(
        colour = PHC6099FinalProject::cbi_base_lightblue,
        hjust = 0,
        vjust = 1,
        margin = margin(t = 0,
                        r = 0,
                        b = base_size * .75,
                        l = 0,
                        unit = "pt")
      ),
      plot.caption = element_text(
        family = base_family,
        size = rel(0.555),
        hjust = 0,
        vjust = 1,
        colour = "black",
        face = "italic",
        margin = ggplot2::margin(t = 15)
      ),
      plot.tag = element_text(
        size = rel(1.2),
        hjust = 0.5,
        vjust = 0.5
      ),
      plot.tag.position = "topleft",
      plot.margin = unit(c(0.5, 0.6, 0.1, 0.01), "lines"),
      complete = TRUE
    )

  # add panel borders if the user requests them
  if (panel_borders) {
    ret <- ret %+replace%
      theme(panel.border = element_rect(
        linetype = 1,
        linewidth = points_to_mm(2),
        colour = "black",
        fill = NA
      ))
  }


  # if (background == "orange" |  background == "box") {
    # ret <- ret +
      # ggplot2::theme(rect = element_rect(
        # fill = PHC6099FinalProject::cbi_base_darkblue))
  # }

  ret

}
```

```{r theme-grattan}
theme_grattan <- function(base_size = 18,
                          base_family = "sans",
                          chart_type = "normal",
                          flipped = FALSE,
                          background = "white",
                          legend = "none",
                          panel_borders = FALSE) {

  if (!chart_type %in% c("normal", "scatter")) {
    warning(paste0("Note: chart_type should be 'normal' or 'scatter', but you entered '",
                   chart_type, "'. Reverting to 'normal'"))
    chart_type <- "normal"
  }

  if (chart_type == "normal") {
    ret <- theme_grattan_normal(base_size = base_size,
                                base_family = base_family,
                                background = background,
                                legend = legend,
                                panel_borders = panel_borders,
                                flipped = flipped)
  }

  if (chart_type == "scatter") {
    ret <- theme_grattan_scatter(base_size = base_size,
                                 base_family = base_family,
                                 background = background,
                                 legend = legend,
                                 panel_borders = panel_borders)
    if (flipped) message("Note that the 'flipped' argument is ignored for scatter plots.")
  }

  # Call a function that modifies various geom defaults
  cbi_geom_defaults()

  # Return
  return(ret)

}
```

```{r}
cbi_base_theme <- function() {
  ret <- theme_bw() + 
        ggplot2::theme(
        axis.line.y = ggplot2::element_blank(),
        axis.ticks.y = ggplot2::element_blank(),
        axis.title.y = ggplot2::element_blank(),
        panel.grid = ggplot2::element_blank()
      )
  cbi_geom_defaults()
  return(ret)
}
```


```{r}
ggplot(mtcars, aes(x = wt, y = mpg)) +
    geom_point() +
    cbi_base_theme()
```

```{r cbi-sim}
ex1_data <- data.frame(x = runif(100) * 1000000, y = runif(100), roi_type = sample(1:2, 100, replace = T))
ex1_data %>%
  ggplot(aes(x = x, y = y, color = roi_type)) + 
  geom_line() +
  cbi_theme_normal() + 
  scale_y_continuous(labels = function(x) sprintf("$%1.2f", x)) +
  scale_x_continuous(labels = format_axis_labels_short)
```

```{r}
plot <- ggplot(iris,
               aes(x = Sepal.Length,
                   y = Sepal.Width,
                   colour = Species)) +
        geom_point(size = 4) +
        labs(x = "Species",
             y = "",
             colour = "Species")
plot

plot + 
  geom_hline(yintercept = 3, colour = cbi_base_weirdblue) +
  geom_vline(xintercept = 6, colour = cbi_base_lightblue) +
  theme_grattan() +
  base_theme()
```
